<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>迁移至webpack2 | Jerexyz</title>
    <meta name="description" content=".....">
    
    
    <link rel="preload" href="/assets/css/0.styles.82bf6693.css" as="style"><link rel="preload" href="/assets/js/app.75db2d94.js" as="script"><link rel="preload" href="/assets/js/2.67788108.js" as="script"><link rel="preload" href="/assets/js/12.243933a4.js" as="script"><link rel="prefetch" href="/assets/js/10.c4888e34.js"><link rel="prefetch" href="/assets/js/11.37c32e56.js"><link rel="prefetch" href="/assets/js/13.5ac260de.js"><link rel="prefetch" href="/assets/js/14.de3b56ee.js"><link rel="prefetch" href="/assets/js/15.dd5a7181.js"><link rel="prefetch" href="/assets/js/16.5bca8d33.js"><link rel="prefetch" href="/assets/js/17.4b6317a5.js"><link rel="prefetch" href="/assets/js/18.ab149834.js"><link rel="prefetch" href="/assets/js/19.8f4b15d7.js"><link rel="prefetch" href="/assets/js/20.ea7287a3.js"><link rel="prefetch" href="/assets/js/3.26116af2.js"><link rel="prefetch" href="/assets/js/4.afd99cf5.js"><link rel="prefetch" href="/assets/js/5.f7fcd5bd.js"><link rel="prefetch" href="/assets/js/6.8d2cea28.js"><link rel="prefetch" href="/assets/js/7.bdaf3636.js"><link rel="prefetch" href="/assets/js/8.8e4f1b9f.js"><link rel="prefetch" href="/assets/js/9.07c67421.js">
    <link rel="stylesheet" href="/assets/css/0.styles.82bf6693.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Jerexyz</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog.html" class="nav-link">Blog</a></div> <a href="https://github.com//jerexyz/jerexyz.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog.html" class="nav-link">Blog</a></div> <a href="https://github.com//jerexyz/jerexyz.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><p><a href="https://webpack.js.org" target="_blank" rel="noopener noreferrer">Webpack2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>很快就要发布了，目前已经到了 2.1.0-beta.25 了，我也是从 2.1.0-beta21 开始关注 webpack2，类似 tree-shaking 等等新特性还是比较令人激动的，现在整理一下从 webpack1 升级到 webpack2 的过程。</p> <p>你也可以查阅<a href="https://webpack.js.org/how-to/upgrade-from-webpack-1/" target="_blank" rel="noopener noreferrer">官方的从 webpack1 至 webpack2 的文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="安装-webpack2"><a href="#安装-webpack2" class="header-anchor">#</a> 安装 webpack2</h2> <p>首先要做的就是安装最新版的 webpack，因为目前还不是稳定版，所以安装的时候最好指定确切的版本。目前最新的是 2.1.--beta.25:</p> <div class="language- extra-class"><pre class="language-text"><code>npm install --save-dev webpack@2.1.0-beta.25
</code></pre></div><p>如果你使用任何其他 webpack 插件，你应该意识到它们同时也需要更新，例如：<a href="extract-text-webpack-plugin">extract-text-webpack-plugin</a></p> <div class="language- extra-class"><pre class="language-text"><code>npm install --save-dev extract-text-webpack-plugin@2.0.0-beta.4
</code></pre></div><h5 id="module-loaders-module-rules"><a href="#module-loaders-module-rules" class="header-anchor">#</a> module.loaders =&gt; module.rules</h5> <p>这并不是一个破坏性的更新，module.loaders 将继续支持，但在未来它将被 module.rules 替换。</p> <div class="language- extra-class"><pre class="language-text"><code>// before
modules: {
 loaders: {...}
}

// after
modules: {
 rules: {...}
}
</code></pre></div><h5 id="resolve-modulesdirectories-resolve-modules"><a href="#resolve-modulesdirectories-resolve-modules" class="header-anchor">#</a> resolve.modulesDirectories =&gt; resolve.modules</h5> <p>另一个重命名的属性，<code>resolve.modulesDirectories</code> 被重命名为 <code>resolve.modules</code></p> <div class="language- extra-class"><pre class="language-text"><code>// before
resolve: {
  modulesDirectories: [...],
}

// after
resolve: {
  modules: [...],
}
</code></pre></div><h5 id="no-webpack-optimize-occurenceorderplugin"><a href="#no-webpack-optimize-occurenceorderplugin" class="header-anchor">#</a> No webpack.optimize.OccurenceOrderPlugin</h5> <p>webpack.optimize.OccurenceOrderPlugin 将被默认包含在 webpack2 当中，所以我们没有必要单独为其配置。</p> <h5 id="configuring-loaders"><a href="#configuring-loaders" class="header-anchor">#</a> Configuring loaders</h5> <p>在日常工作中我们使用 postcss 和<a href="https://github.com/postcss/postcss-loader" target="_blank" rel="noopener noreferrer">postcss-loader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>通过 Webpack 装载 CSS。postcss 作为顶级属性在 webpack 当中配置。在 webpack2 中，这样是不被允许的；我们可以选择为 loader 配置一个 options 属性。任何插件，寻找顶级的配置将要被改变为这种风格。</p> <div class="language- extra-class"><pre class="language-text"><code>// before, in Webpack top level
postcss: {
  plugins: ...
}

// after
module: {
  rules: [{
    test: /\.scss$/,
    use: [
      {
        loader: 'postcss-loader',
        options: {
          plugins: ...
        }
      },
      'sass-loader'
    ]
  }]
}
</code></pre></div><h5 id="extracttextplugin-changes"><a href="#extracttextplugin-changes" class="header-anchor">#</a> ExtractTextPlugin changes</h5> <p>上述对 loader 配置的变化也使得更容易配置多个 loader，以前可以只能通过字符串拼接的形式，现在改为了一个数组，如 ExtractTextPlugin：</p> <div class="language- extra-class"><pre class="language-text"><code>// Webpack 1
ExtractTextPlugin.extract(
  'style-loader',
  'css-loader!postcss-loader!sass-loader'
);
</code></pre></div><p>这样很难工作，如果你不得不配置选项：</p> <div class="language- extra-class"><pre class="language-text"><code>// Webpack 1
ExtractTextPlugin.extract(
  'style-loader',
  'css-loader?modules-true!postcss-loader!sass-loader'
);
</code></pre></div><p>webpack2 使用 Array 结合 Object 来配置 loaders，这样就胡 i 方便很多，我们可以很容易的将上面的配置替换掉。</p> <div class="language- extra-class"><pre class="language-text"><code>// Webpack 2
var loaders = [
  {
    loader: 'css-loader',
    options: {
      modules: true
    }
  },
  {
    loader: 'postcss-loader'
  },
  {
    loader: 'sass-loader'
  }
]
</code></pre></div><p>webpack1 我们使用 key query 配置 loaders，现在 extracttextplugin 可以使用 Array 配置，而不是只允许字符串形式：</p> <div class="language- extra-class"><pre class="language-text"><code>// Webpack 2
ExtractTextPlugin.extract({
  fallbackLoader: 'style-loader',
  loader: loaders,
})
</code></pre></div><h5 id="stop-babel-from-compiling-es2015-modules"><a href="#stop-babel-from-compiling-es2015-modules" class="header-anchor">#</a> Stop Babel from compiling ES2015 modules</h5> <p>webpack1 无法解析 es2015 module，所以 babel 将其转换成 CommonJs。webpack2 可以解析 es2015 module，并能够消除死代码的基础上使用 module，所以建议你告诉 Babel 不将其转换成 CommonJS 模块。你可以通过改变 babelrc 配置实现：</p> <div class="language- extra-class"><pre class="language-text"><code>// before
&quot;presets&quot;: [&quot;es2015&quot;]

// after
&quot;presets&quot;: [
  [&quot;es2015&quot;, { &quot;modules&quot;: false }]
]
</code></pre></div><p>此文为本人根据<a href="http://javascriptplayground.com/blog/2016/10/moving-to-webpack-2/" target="_blank" rel="noopener noreferrer">http://javascriptplayground.com/blog/2016/10/moving-to-webpack-2/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>翻译而来</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com//jerexyz/jerexyz.github.io/edit/master/docs/moving-to-webpack2/index.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.75db2d94.js" defer></script><script src="/assets/js/2.67788108.js" defer></script><script src="/assets/js/12.243933a4.js" defer></script>
  </body>
</html>
